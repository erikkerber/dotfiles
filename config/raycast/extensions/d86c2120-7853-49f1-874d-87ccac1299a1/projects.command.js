var D=Object.create;var d=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var J=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var y=e=>d(e,"__esModule",{value:!0});var $=(e,t)=>{for(var r in t)d(e,r,{get:t[r],enumerable:!0})},j=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of J(t))!v.call(e,o)&&(r||o!=="default")&&d(e,o,{get:()=>t[o],enumerable:!(i=O(t,o))||i.enumerable});return e},P=(e,t)=>j(y(d(e!=null?D(b(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),E=(e=>(t,r)=>e&&e.get(t)||(r=j(y({}),t,1),e&&e.set(t,r),r))(typeof WeakMap!="undefined"?new WeakMap:0);var B={};$(B,{default:()=>z});var f=require("@raycast/api"),u=require("react");var S=require("@raycast/api");var n=require("@raycast/api");var c=(o=>(o.project="xcodeproj",o.workspace="xcworkspace",o.swiftPackage="swift",o.swiftPlayground="playground",o))(c||{});var p=P(require("path"),1),w=P(require("os"),1),k=w.default.homedir();function g(e){let t=p.default.normalize(e)+p.default.sep;return(t.startsWith(k)?t.replace(k+p.default.sep,`~${p.default.sep}`):t).slice(0,-1)}function X(e,t=null){return _jsx(n.List.Item,{key:e.filePath,title:e.name,subtitle:g(e.filePath),accessoryTitle:K(e.type),keywords:e.keywords,icon:{source:T(e.type)},actions:_jsx(n.ActionPanel,null,t?t(e):M(e))})}function M(e){return[_jsx(n.OpenAction,{key:"open-with-xcode",title:"Open with Xcode",target:e.filePath}),_jsx(n.ShowInFinderAction,{key:"show-in-finder",path:e.filePath})]}function T(e){switch(e){case"xcodeproj":return"xcode-project.png";case"xcworkspace":return"xcode-workspace.png";case"swift":return"swift-package.png";case"playground":return"swift-playground.png"}}function K(e){switch(e){case"xcodeproj":return"Project";case"xcworkspace":return"Workspace";case"swift":return"Swift Package";case"playground":return"Playground"}}function x(e){return _jsx(S.List,{isLoading:!e,searchBarPlaceholder:"Search for Xcode Projects or Swift Packages"},e?.map(t=>X(t)))}var l=require("@raycast/api");var A=require("child_process"),L=require("util"),m=(0,L.promisify)(A.exec);function I(e){let t;return Array.isArray(e)?t=e.map(r=>`-e '${r}'`).join(" "):t=`-e '${e}'`,m(`osascript ${t}`).then(r=>r.stdout)}var N=P(require("path"));function C(...e){return N.join(...e)}var s=class{constructor(){this.xcodeProjectsJSONLocalStorageKey="xcode-projects"}async cachedXcodeProjects(){let t=await(0,l.getLocalStorageItem)(this.xcodeProjectsJSONLocalStorageKey);if(!!t)return JSON.parse(t)}cacheXcodeProjects(t){return(0,l.setLocalStorageItem)(this.xcodeProjectsJSONLocalStorageKey,JSON.stringify(t))}async xcodeProjects(){let i=(await m(`mdfind '${["kMDItemDisplayName == *.xcodeproj","kMDItemDisplayName == *.xcworkspace","kMDItemDisplayName == Package.swift","kMDItemDisplayName == *.playground"].join(" || ")}'`)).stdout.split(`
`).filter(o=>!o.includes("Carthage/Checkouts")&&!o.includes("Pods")&&!o.includes("Library/Autosave Information")).map(o=>s.decodeXcodeProject(o)).filter(o=>!!o);return this.cacheXcodeProjects(i).then(),i}async openedXcodeProjects(){let t;try{t=await I(['tell application "Xcode"',"return path of workspace documents","end tell"])}catch{return[]}return t.trim()?t.split(",").map(r=>r.trim()).map(r=>r.split("/").at(-1)?.includes(".")?r:C(r,"Package.swift")).map(r=>s.decodeXcodeProject(r)).filter(r=>!!r):[]}static decodeXcodeProject(t){let r=t.substring(t.lastIndexOf("/")+1),i=r.split(".").at(-1),o;switch(i){case"xcodeproj":case"xcworkspace":case"playground":let h=r.split(".");h.pop(),o=h.join(".");break;case"swift":o=t.split("/").at(-2)??r;break;default:return}let a=t.split("/");return a.pop(),a.push(o),a=[...new Set(a.filter(Boolean))],{name:o,type:i,filePath:t,keywords:a.reverse()}}};var z=()=>{let e=new s,[t,r]=(0,u.useState)(void 0);return(0,u.useEffect)(()=>{e.cachedXcodeProjects().then(i=>{t||r(i)}).catch(console.error),e.xcodeProjects().then(r).catch(i=>(t||r([]),console.error(i),(0,f.showToast)(f.ToastStyle.Failure,"An error occurred while finding Xcode Projects",i)))},[]),x(t)};module.exports=E(B);0&&(module.exports={});
