var C=Object.create;var l=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var g=e=>l(e,"__esModule",{value:!0});var b=(e,t)=>{g(e);for(var o in t)l(e,o,{get:t[o],enumerable:!0})},$=(e,t,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of O(t))!v.call(e,c)&&c!=="default"&&l(e,c,{get:()=>t[c],enumerable:!(o=D(t,c))||o.enumerable});return e},i=e=>$(g(l(e!=null?C(J(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);b(exports,{default:()=>z});var u=i(require("@raycast/api")),P=i(require("react"));var k=i(require("@raycast/api"));var n=i(require("@raycast/api"));var s;(function(r){r.project="xcodeproj",r.workspace="xcworkspace",r.swiftPackage="swift",r.swiftPlayground="playground"})(s||(s={}));var d=i(require("path")),y=i(require("os")),w=y.default.homedir();function h(e){let t=d.default.normalize(e)+d.default.sep;return(t.startsWith(w)?t.replace(w+d.default.sep,`~${d.default.sep}`):t).slice(0,-1)}function x(e,t=null){return _jsx(n.List.Item,{key:e.filePath,title:e.name,subtitle:h(e.filePath),accessoryTitle:K(e.type),keywords:e.keywords,icon:{source:M(e.type)},actions:_jsx(n.ActionPanel,null,t?t(e):E(e))})}function E(e){return[_jsx(n.OpenAction,{key:"open-with-xcode",title:"Open with Xcode",target:e.filePath}),_jsx(n.ShowInFinderAction,{key:"show-in-finder",path:e.filePath})]}function M(e){switch(e){case s.project:return"xcode-project.png";case s.workspace:return"xcode-workspace.png";case s.swiftPackage:return"swift-package.png";case s.swiftPlayground:return"swift-playground.png"}}function K(e){switch(e){case s.project:return"Project";case s.workspace:return"Workspace";case s.swiftPackage:return"Swift Package";case s.swiftPlayground:return"Playground"}}function X(e){return _jsx(k.List,{isLoading:!e,searchBarPlaceholder:"Search for Xcode Projects or Swift Packages"},e?.map(t=>x(t)))}var f=i(require("@raycast/api"));var S=i(require("child_process")),A=i(require("util")),m=(0,A.promisify)(S.exec);function L(e){let t;return Array.isArray(e)?t=e.map(o=>`-e '${o}'`).join(" "):t=`-e '${e}'`,m(`osascript ${t}`).then(o=>o.stdout)}var I=i(require("path"));function N(...e){return I.join(...e)}var a=class{constructor(){this.xcodeProjectsJSONLocalStorageKey="xcode-projects"}async cachedXcodeProjects(){let t=await(0,f.getLocalStorageItem)(this.xcodeProjectsJSONLocalStorageKey);if(!!t)return JSON.parse(t)}cacheXcodeProjects(t){return(0,f.setLocalStorageItem)(this.xcodeProjectsJSONLocalStorageKey,JSON.stringify(t))}async xcodeProjects(){let c=(await m(`mdfind '${["kMDItemDisplayName == *.xcodeproj","kMDItemDisplayName == *.xcworkspace","kMDItemDisplayName == Package.swift","kMDItemDisplayName == *.playground"].join(" || ")}'`)).stdout.split(`
`).filter(r=>!r.includes("Carthage/Checkouts")&&!r.includes("Pods")&&!r.includes("Library/Autosave Information")).map(r=>a.decodeXcodeProject(r)).filter(r=>!!r);return this.cacheXcodeProjects(c).then(),c}async openedXcodeProjects(){let t;try{t=await L(['tell application "Xcode"',"return path of workspace documents","end tell"])}catch{return[]}return t.trim()?t.split(",").map(o=>o.trim()).map(o=>o.split("/").at(-1)?.includes(".")?o:N(o,"Package.swift")).map(o=>a.decodeXcodeProject(o)).filter(o=>!!o):[]}static decodeXcodeProject(t){let o=t.substring(t.lastIndexOf("/")+1),c=o.split(".").at(-1),r;switch(c){case s.project:case s.workspace:case s.swiftPlayground:let j=o.split(".");j.pop(),r=j.join(".");break;case s.swiftPackage:r=t.split("/").at(-2)??o;break;default:return}let p=t.split("/");return p.pop(),p.push(r),p=[...new Set(p.filter(Boolean))],{name:r,type:c,filePath:t,keywords:p.reverse()}}};var z=()=>{let e=new a,[t,o]=(0,P.useState)(void 0);return(0,P.useEffect)(()=>{e.cachedXcodeProjects().then(c=>{t||o(c)}).catch(console.error),e.xcodeProjects().then(o).catch(c=>(t||o([]),console.error(c),(0,u.showToast)(u.ToastStyle.Failure,"An error occurred while finding Xcode Projects",c)))},[]),X(t)};0&&(module.exports={});
